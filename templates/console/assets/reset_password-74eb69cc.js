import{r as t,w as B,af as O,j as e,z,a7 as G,a8 as U,a9 as W,S as m,T as n,aa as p,Q as x,a5 as g,ai as q}from"./index-69ca1816.js";import{E as J,L as N}from"./ErrorMessage-58973ad9.js";import{C as Q}from"./CircularProgress-ab1f7460.js";import{T as w}from"./TextField-09885ad5.js";import{I as j}from"./InputAdornment-c0873d0e.js";function Z(){const[y,v]=t.useState(""),[a,P]=t.useState(""),[l,b]=t.useState(""),[S,r]=t.useState(""),[k,i]=t.useState(!1),[C,I]=t.useState(!1),L=B(),c=O(),[d,T]=t.useState(!1),[u,R]=t.useState(!1),[E,F]=t.useState(!1);t.useEffect(()=>{const s=new URLSearchParams(c.search).get("token");v(s),console.log(s)},[c]);const _=()=>typeof a!="string"?"Password must be a string":a.length<8?"Password must be at least 8 characters long":l!==a?"Passwords do not match":null,A=async s=>{s.preventDefault(),i(!0);const f=_();if(f){i(!1),r(f);return}const M={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y,new_password:a})};try{const o=await q(M),h=await o.json();console.log(o),console.log(h),o.ok||r(h.detail),o.status===401&&I(!0),F(!0)}catch{r("An error occurred. Please try again.")}finally{i(!1)}},D=e.jsxs(e.Fragment,{children:[e.jsxs(m,{spacing:2,children:[e.jsx(w,{value:a,name:"password",label:"Password",onChange:s=>P(s.target.value),type:d?"text":"password",InputProps:{endAdornment:e.jsx(j,{position:"end",children:e.jsx(x,{onClick:()=>T(!d),edge:"end",children:e.jsx(g,{icon:d?"eva:eye-fill":"eva:eye-off-fill"})})})}})," ",e.jsx(w,{value:l,name:"confirm_password",label:"Confirm Password",onChange:s=>b(s.target.value),type:u?"text":"password",InputProps:{endAdornment:e.jsx(j,{position:"end",children:e.jsx(x,{onClick:()=>R(s=>!s),edge:"end",children:e.jsx(g,{icon:u?"eva:eye-fill":"eva:eye-off-fill"})})})}})]}),e.jsx(J,{message:S}),C&&e.jsxs(n,{variant:"body2",sx:{mt:2,mb:5},children:["Didn't receive verification code? ",e.jsx(p,{to:"/verification",variant:"subtitle2",children:"Resend"})]}),e.jsx(N,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",loading:k,onClick:A,children:"Forgot Password"})]});return e.jsxs(z,{sx:{...G({color:U(L.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[e.jsx(W,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),e.jsx(m,{alignItems:"center",justifyContent:"center",sx:{height:1},children:e.jsxs(Q,{sx:{"&::-webkit-scrollbar":{display:"none"},p:5,width:1,maxWidth:420},children:[e.jsx(n,{variant:"h4",mb:4,children:"Reset Password"}),E?e.jsx(n,{variant:"h4",mb:4,children:"Password Reset Successfully"}):e.jsxs(e.Fragment,{children:[" ",D,e.jsxs(n,{variant:"body2",sx:{mt:5,mb:2},children:["Don’t have an account? ",e.jsx(p,{to:"/signup",variant:"subtitle2",style:{textDecoration:"none"},children:"Get started"})]})]})]})})]})}export{Z as default};
